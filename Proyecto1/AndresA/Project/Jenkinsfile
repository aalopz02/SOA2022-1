pipeline {
    agent { docker { image 'python:3.10.1-alpine' } }
    stages {
		stage('check') {
            steps {
                sh 'pylint cosa.py --disable=all --enable=E,W,C0116 --reports=no module --output-format=parseable > pylint.log'
				LINT_RESULT = sh(
					script:'echo | python3 logParser.py'
					returnStdout: true
				).trim()
				echo "lintRes: ${LINT_RESULT}"
				if (LINT_RESULT >= 8){
					echo 'ok'
				} else {
					echo 'fail'
				}
            }
        }
        stage('build') {
            steps {
                sh 'python --version'
            }
        }
    }
}